<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>Golden Fingers Sk√∂vde - Boka Tid</title>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <style>
    body {
      background: linear-gradient(45deg,#ff6b6b,#4ecdc4,#45b7d1,#96ceb4);
      background-size: 300% 300%;
      animation: bgMove 5s ease infinite;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    @keyframes bgMove {
      0%,100%{background-position:0% 50%}
      50%{background-position:100% 50%}
    }
    .container { max-width: 1200px; margin: 0 auto; text-align: center; }
    h1 {
      font-size: 3.2em;
      margin-bottom: 5px;
      background: linear-gradient(45deg,#ffd700,#ffa500,#ffffff);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      text-shadow: 0 0 25px rgba(0,0,0,0.3);
    }
    h2 { color:#fff; margin-top:5px; }
    .btn {
      background: linear-gradient(45deg,#ffd700,#ffa500);
      border: none;
      border-radius: 40px;
      padding: 12px 28px;
      font-size: 16px;
      cursor: pointer;
      color:#000;
      margin: 8px;
      box-shadow: 0 8px 22px rgba(0,0,0,0.3);
      transition: transform .2s;
    }
    .btn:hover { transform: scale(1.05); }
    .lang-btn {
      position: fixed;
      right: 15px;
      top: 15px;
      z-index: 1000;
      padding: 6px 16px;
      font-size: 13px;
    }
    .slots {
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      margin-top:15px;
    }
    .slot {
      padding:14px 20px;
      margin:8px;
      border-radius:18px;
      font-weight:bold;
      cursor:pointer;
      min-width:100px;
      transition:.2s;
    }
    .available {
      background:linear-gradient(45deg,#4caf50,#45a049);
      color:#fff;
      box-shadow:0 8px 18px rgba(76,175,80,0.5);
    }
    .available:hover { transform:scale(1.08); }
    .reserved {
      background:linear-gradient(45deg,#ffb300,#ff9800);
      color:#fff;
    }
    .paid {
      background:linear-gradient(45deg,#2e7d32,#1b5e20);
      color:#fff;
    }
    .section {
      background:rgba(255,255,255,0.95);
      border-radius:20px;
      padding:20px;
      margin-top:20px;
      box-shadow:0 12px 30px rgba(0,0,0,0.25);
      text-align:left;
    }
    #bookingForm {
      max-width:420px;
      margin:20px auto;
      display:none;
    }
    label { display:block; margin-top:8px; font-size:14px; }
    input,select {
      width:100%;
      padding:10px;
      border-radius:12px;
      border:2px solid #ddd;
      margin-top:4px;
      box-sizing:border-box;
      font-size:14px;
    }
    .warning {
      background:linear-gradient(45deg,#ff9800,#f57c00);
      color:#fff;
      padding:10px;
      border-radius:12px;
      font-size:12px;
      margin-top:10px;
    }
    .booking-item {
      margin:6px 0;
      padding:8px 10px;
      border-radius:12px;
      background:#f5f5f5;
      font-size:14px;
    }
    .booking-actions button {
      font-size:11px;
      padding:4px 10px;
      margin-left:4px;
    }
    .swish-qr {
      max-width:160px;
      display:block;
      margin:10px auto;
    }
  </style>
</head>
<body>
<div class="container">
  <button class="btn lang-btn" onclick="toggleLang()">üá∏üá™ / üá∏üá¶</button>

  <h1>Golden Fingers Sk√∂vde</h1>
  <h2 id="subtitle">Boka din tid online</h2>
  <p style="color:#fff;font-weight:bold;">
    Klippning 250 SEK ¬∑ Ny kund 99 SEK ¬∑ √ñppet 10:00‚Äì18:00
  </p>

  <h2 id="timeTitle">V√§lj tid idag (max 8 tider)</h2>
  <div id="slots" class="slots"></div>

  <div id="dropinInfo" style="display:none;margin-top:20px;color:#fff;font-size:1.2em;font-weight:bold;">
    Fredag & l√∂rdag: Endast drop‚Äëin (k√∂‚Äësystem) i salongen. Ingen onlinebokning.
  </div>

  <div id="bookingForm" class="section">
    <h3>üìã Boka tid</h3>
    <label>Namn</label>
    <input id="name" type="text" placeholder="Fullt namn">
    <label>Telefon</label>
    <input id="phone" type="tel" placeholder="+46...">
    <label>E‚Äëpost</label>
    <input id="email" type="email" placeholder="kund@mail.se">
    <label>Tj√§nst</label>
    <select id="service">
      <option value="250">‚úÇÔ∏è Klippning 250 SEK</option>
      <option value="99">üéâ Ny kund 99 SEK</option>
    </select>
    <button class="btn" type="button" style="width:100%;margin-top:10px;" onclick="bookAndPay()">
      ‚úÖ Boka & betala med Swish
    </button>
    <div class="warning">
      ‚ö†Ô∏è Avbokning: Ingen √•terbetalning. Vid avbokning f√∂rloras hela beloppet.
    </div>
    <div style="text-align:center;margin-top:10px;">
      <strong>Swish:</strong> 1236112585<br>
      <img class="swish-qr"
           src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=SWISH:1236112585"
           alt="Swish QR">
    </div>
  </div>

  <div id="todayBookings" class="section">
    <h3>üìÖ Dagens bokningar</h3>
    <div id="bookingList"></div>
    <p style="font-size:12px;color:#555;margin-top:8px;">
      Klicka ‚úÖ n√§r betalning syns p√• Swish. ‚ùå tar bort bokningen och frig√∂r tiden.
    </p>
  </div>
</div>

<script>
  // EmailJS init
  emailjs.init("RdqnDhUxmbBR69lCQ"); // Public key ÿ™ÿ®ÿπŸÉ [web:39]

  const SERVICE_ID   = "service_osd1mqu";
  const TEMPLATE_ID  = "template_erd8bqc";
  const SALON_EMAIL  = "omar1tftnaze@gmail.com";
  const SWISH_NUMBER = "1236112585";

  let lang = "sv";
  const slots = ["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00"];
  let selectedTime = null;
  let bookings = JSON.parse(localStorage.getItem("gf_bookings") || "[]");

  function saveBookings() {
    localStorage.setItem("gf_bookings", JSON.stringify(bookings));
  }

  function toggleLang() {
    lang = lang === "sv" ? "ar" : "sv";
    document.getElementById("subtitle").textContent =
      lang === "sv" ? "Boka din tid online" : "ÿßÿ≠ÿ¨ÿ≤ ŸÖŸàÿπÿØŸÉ ÿ£ŸàŸÜŸÑÿßŸäŸÜ";
    document.getElementById("timeTitle").textContent =
      lang === "sv" ? "V√§lj tid idag (max 8 tider)" : "ÿßÿÆÿ™ÿ± ŸàŸÇÿ™ ÿßŸÑŸäŸàŸÖ (ÿ≠ÿ™Ÿâ Ÿ® ŸÖŸàÿßÿπŸäÿØ)";
  }

  function isWeekend() {
    const d = new Date();
    const day = d.getDay(); // 0=Sunday ... 5=Friday, 6=Saturday [web:53]
    return day === 5 || day === 6;
  }

  function initSlots() {
    const slotsDiv   = document.getElementById("slots");
    const dropinInfo = document.getElementById("dropinInfo");
    const form       = document.getElementById("bookingForm");
    const todayStr   = new Date().toISOString().split("T")[0];

    if (isWeekend()) {
      slotsDiv.innerHTML = "";
      form.style.display = "none";
      dropinInfo.style.display = "block";
      updateBookingList();
      return;
    } else {
      dropinInfo.style.display = "none";
      form.style.display = "block";
    }

    slotsDiv.innerHTML = "";
    const todays = bookings.filter(b => b.date === todayStr);
    slots.forEach(time => {
      const b = todays.find(x => x.time === time);
      const div = document.createElement("div");
      let cls = "available";
      let label = time;

      if (b) {
        if (b.status === "paid") {
          cls = "paid";
          label = time + " ‚úî";
        } else {
          cls = "reserved";
          label = time + " (reserverad)";
        }
      } else {
        div.onclick = () => selectSlot(time);
      }
      div.className = "slot " + cls;
      div.textContent = label;
      slotsDiv.appendChild(div);
    });

    updateBookingList();
  }

  function selectSlot(time) {
    selectedTime = time;
    document.getElementById("bookingForm").scrollIntoView({behavior:"smooth"});
  }

  function bookAndPay() {
    const name  = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const email = document.getElementById("email").value.trim();
    const priceVal = document.getElementById("service").value;

    if (!selectedTime || !name || !phone || !email) {
      alert(lang === "sv" ? "Fyll i alla f√§lt och v√§lj tid." : "ÿßŸÖŸÑÿß ŸÉŸÑ ÿßŸÑÿ≠ŸÇŸàŸÑ ŸàÿßÿÆÿ™ÿ± ŸàŸÇÿ™ÿßŸã.");
      return;
    }

    const todayStr = new Date().toISOString().split("T")[0];
    const existing = bookings.find(b => b.date === todayStr && b.time === selectedTime);
    if (existing) {
      alert("Tiden √§r redan reserverad.");
      initSlots();
      return;
    }

    const booking = {
      id: Date.now(),
      date: todayStr,
      time: selectedTime,
      name,
      phone,
      email,
      price: parseInt(priceVal,10),
      service: priceVal === "99" ? "Ny kund 99 SEK" : "Klippning 250 SEK",
      status: "reserved",   // reserved -> paid
      reminded: false
    };
    bookings.push(booking);
    saveBookings();

    sendEmails(booking);   // Ÿäÿ±ÿ≥ŸÑ ŸÑŸÉ ŸàŸÑŸÑÿ≤ÿ®ŸàŸÜ ŸÖÿπÿßŸã [web:113]

    alert(`Din tid ${booking.time} √§r reserverad.
Betala ${booking.price} SEK till Swish ${SWISH_NUMBER}.`);

    openSwish(booking);    // ŸÖÿ≠ÿßŸàŸÑÿ© ŸÅÿ™ÿ≠ ÿ™ÿ∑ÿ®ŸäŸÇ Swish [web:92]

    // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸÅŸàÿ±ŸÖ
    document.getElementById("name").value  = "";
    document.getElementById("phone").value = "";
    document.getElementById("email").value = "";
    document.getElementById("service").value = "250";
    selectedTime = null;
    initSlots();
  }

  function sendEmails(booking) {
    const baseMessage = `
Namn: ${booking.name}
Telefon: ${booking.phone}
Tid: ${booking.time}
Pris: ${booking.price} SEK
Datum: ${booking.date}
    `;

    // 1) ÿ•ŸäŸÖŸäŸÑ ŸÑÿµÿßÿ≠ÿ® ÿßŸÑÿµÿßŸÑŸàŸÜ
    emailjs.send(SERVICE_ID, TEMPLATE_ID, {
      to_email: SALON_EMAIL,
      name: booking.name,
      phone: booking.phone,
      time: booking.time,
      price: booking.price,
      message: "NY BOKNING!
" + baseMessage + "
Golden Fingers Sk√∂vde"
    });

    // 2) ÿ•ŸäŸÖŸäŸÑ ÿ™ÿ£ŸÉŸäÿØ ŸÑŸÑÿ≤ÿ®ŸàŸÜ
    emailjs.send(SERVICE_ID, TEMPLATE_ID, {
      to_email: booking.email,
      name: booking.name,
      phone: booking.phone,
      time: booking.time,
      price: booking.price,
      message:
        `Tack ${booking.name}!
` +
        baseMessage +
        `
Swish: ${SWISH_NUMBER}
Viktigt: Ingen √•terbetalning vid avbokning.`
    });
  }

  function openSwish(booking) {
    const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);
    const amount   = booking.price;

    if (isMobile) {
      const url = `swish://payment?number=${SWISH_NUMBER}&amount=${amount}`;
      window.location.href = url;
    } else {
      window.open(
        `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=SWISH:${SWISH_NUMBER}`,
        "_blank"
      );
    }
  }

  function updateBookingList() {
    const list = document.getElementById("bookingList");
    const todayStr = new Date().toISOString().split("T")[0];
    const todays = bookings.filter(b => b.date === todayStr);

    if (!todays.length) {
      list.innerHTML = "<p style='color:#777;font-style:italic;'>Inga bokningar idag.</p>";
      return;
    }

    list.innerHTML = todays.map(b => `
      <div class="booking-item">
        <strong>${b.time}</strong> ‚Äì ${b.name} (${b.service}) ${b.price} SEK
        <span style="float:right;color:${b.status === "paid" ? "green" : "orange"};">
          ${b.status === "paid" ? "Betald" : "Reserverad"}
        </span>
        <div class="booking-actions" style="margin-top:4px;text-align:right;">
          <button class="btn" style="background:#4caf50;color:#fff;padding:4px 8px;font-size:11px;"
                  onclick="markPaid(${b.id})">‚úÖ Betald</button>
          <button class="btn" style="background:#f44336;color:#fff;padding:4px 8px;font-size:11px;"
                  onclick="removeBooking(${b.id})">‚ùå Ta bort</button>
        </div>
      </div>
    `).join("");
  }

  function markPaid(id) {
    const b = bookings.find(x => x.id === id);
    if (b) {
      b.status = "paid";
      saveBookings();
      initSlots();
    }
  }

  function removeBooking(id) {
    if (!confirm("Ta bort bokningen och frig√∂ra tiden?")) return;
    bookings = bookings.filter(b => b.id !== id);
    saveBookings();
    initSlots();
  }

  // ÿ™ÿ∞ŸÉŸäÿ± ÿØÿßÿÆŸÑŸä 30 ÿØŸÇŸäŸÇÿ© ŸÇÿ®ŸÑ ÿßŸÑŸÖŸàÿπÿØ
  setInterval(() => {
    const now = new Date();
    bookings.forEach(b => {
      const t = new Date(`${b.date}T${b.time}:00`);
      const diff = t - now;
      if (diff > 0 && diff <= 30*60*1000 && !b.reminded) {
        console.log(`P√•minnelse 30 min: ${b.name} ${b.time}`);
        b.reminded = true;
        saveBookings();
      }
    });
  }, 60000);

  initSlots();
</script>
</body>
</html>9
